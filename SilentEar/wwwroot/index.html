<!-- @format -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>SilentEar</title>
    <base href="/" />
    <link rel="stylesheet" href="css/bootstrap/bootstrap.min.css" />
    <link rel="stylesheet" href="css/app.css" />
    <link rel="icon" type="image/png" href="favicon.png" />
    <link href="SilentEar.styles.css" rel="stylesheet" />
    <link rel="manifest" href="manifest.webmanifest" />
    <link rel="apple-touch-icon" sizes="512x512" href="icon-512.png" />
    <link rel="apple-touch-icon" sizes="192x192" href="icon-192.png" />
    <meta name="theme-color" content="#1a1a1a" />
  </head>

  <body>
    <div
      id="static-splash"
      style="
        position: fixed;
        z-index: 9999;
        inset: 0;
        background: #1a1a1a;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
      ">
      <h1 style="color: #fff; font-size: 2.5rem; margin-bottom: 1.5rem">
        Silent Ear
      </h1>
      <div style="display: flex; gap: 0.5rem">
        <div
          style="
            width: 16px;
            height: 16px;
            background: #fff;
            border-radius: 50%;
            animation: splash-bounce 1s infinite alternate;
          "></div>
        <div
          style="
            width: 16px;
            height: 16px;
            background: #fff;
            border-radius: 50%;
            animation: splash-bounce 1s 0.3s infinite alternate;
          "></div>
        <div
          style="
            width: 16px;
            height: 16px;
            background: #fff;
            border-radius: 50%;
            animation: splash-bounce 1s 0.6s infinite alternate;
          "></div>
      </div>
      <style>
        @keyframes splash-bounce {
          0% {
            transform: translateY(0);
            opacity: 0.7;
          }
          100% {
            transform: translateY(-20px);
            opacity: 1;
          }
        }
      </style>
    </div>

    <div id="app">
      <svg class="loading-progress">
        <circle r="40%" cx="50%" cy="50%" />
        <circle r="40%" cx="50%" cy="50%" />
      </svg>
      <div class="loading-progress-text"></div>
    </div>

    <div id="blazor-error-ui">
      An unhandled error has occurred.
      <a href="" class="reload">Reload</a>
      <a class="dismiss">ðŸ—™</a>
    </div>
    <script src="_content/Microsoft.AspNetCore.Components.WebAssembly.Authentication/AuthenticationService.js"></script>
    <script src="_framework/blazor.webassembly.js"></script>
    <script>
      // Safe service worker registration with error handling
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker
          .register("service-worker.js")
          .catch(function (error) {
            console.log("Service Worker registration failed:", error);
          });
      }
    </script>
    <script src="js/audioRecorder.js"></script>
    <script>
      // Disable source map requests to prevent 404 errors
      window.addEventListener("error", function (e) {
        if (e.filename && e.filename.endsWith(".map")) {
          e.preventDefault();
          return false;
        }
      });

      // Hide splash screen when Blazor starts (don't call Blazor.start() as it auto-starts)
      window.addEventListener("DOMContentLoaded", function () {
        // Listen for Blazor ready event instead of manually starting
        document.addEventListener("DOMContentLoaded", function () {
          setTimeout(function () {
            var splash = document.getElementById("static-splash");
            if (splash) splash.style.display = "none";
          }, 2000); // Hide after 2 seconds
        });
      });
    </script>
  </body>
</html>
